# Техническое задание: Sales Copilot

## 1. Общий обзор

**Sales Copilot** — интеллектуальный помощник для менеджеров по продажам и партнёрским менеджерам «Лаборатории Касперского». Его цель — повышение эффективности коммуникации, автоматизация подготовки писем, снижение ошибок, повышение удовлетворённости клиентов и рост выручки.

### Основные функции:
- Анализ истории переписки с клиентами и партнёрами
- Генерация ответов, писем и рекомендаций по продажам
- Автоматическое добавление маркетинговых и продуктовых материалов
- Проверка сообщений на соответствие базе знаний и политике компании
- Рекомендации по апсейлу/кросс-сейлу продуктов
- Работа с конфликтными ситуациями

---

## 2. Примеры сценариев использования

### 2.1 Клиент интересуется функциями продукта
Copilot анализирует переписку, вызывает MCP для получения актуальных данных о продукте и вставляет краткое описание Kaspersky Endpoint Security.

### 2.2 Апсейл
Выявив устаревшую версию у клиента, Copilot предлагает перейти на Premium Plus, обосновывая выгоды, извлечённые из MCP.

### 2.3 Проверка фактов
Менеджер пишет неверную информацию. Copilot проверяет утверждения через MCP, выявляет расхождения и предлагает корректный вариант.

### 2.4 Добавление маркетинговых материалов
Copilot вызывает MCP, получает актуальные ссылки и вставляет материалы из маркетингового департамента в черновик письма.

### 2.5 Разрешение конфликта
Copilot анализирует тональность переписки, выявляет боли клиента и с помощью LLM генерирует мягкий ответ для деэскалации конфликта.

---

## 3. Архитектура системы

```plaintext
[Менеджер / Партнёр]
      ↓ HTTPS/OAuth2
[Bot UI: Outlook/Telegram/Web]
      ↓ REST API
[Sales Copilot Core (LLM)]
      ↓
  [MCP (Model Context Protocol)]
      ↓
 ┌─────────────┬──────────────┐
 │ KB (YAML)   │ RAG Engine   │
 │             │ (FAISS, ES)  │
 └─────────────┴──────────────┘
```

---

## 4. MCP (Model Context Protocol)

MCP — основной модуль, предоставляющий LLM доступ к корпоративной базе знаний ЛК. Он используется для:
- Семантического поиска по справочным данным
- Валидации утверждений и характеристик
- Подстановки актуальных ссылок и политик

### Интерфейс
- REST API (`/query`) с параметрами: `topic`, `query_type`, `language`
- Формат запроса/ответа соответствует Pydantic-схемам
- Интеграция с RAG (Retriever-Augmented Generation): FAISS + Elasticsearch



---

## 5. Модули Sales Copilot

| Модуль              | Описание |
|---------------------|----------|
| **UI**              | Outlook, Telegram, Web (React) |
| **Email Assistant** | Генерация писем с разными стилями |
| **Context Analyzer**| Анализ тональности, намерений, проблем клиента |
| **Pricing Module**  | Расчёт цен, рекомендации по пакетам |
| **Compliance Checker** | Проверка утверждений через MCP |
| **Content Inserter** | Вставка ссылок и блоков через RAG |
| **LLM Core**        | Генерация ответов с вызовом MCP |

---

## 6. Технологии

| Компонент           | Технологии |
|---------------------|------------|
| UI                  | React/Next.js, aiogram, Outlook API |
| API                 | FastAPI, Redis |
| MCP                 | FAISS, Elasticsearch, Pydantic |
| Анализ              | spaCy, PyTorch, LangChain |
| LLM                 | OpenAI / GigaChat / YaGPT |
| Хранение            | PostgreSQL, MinIO/S3 |
